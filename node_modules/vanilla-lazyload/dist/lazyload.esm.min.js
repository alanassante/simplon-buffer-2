const t="undefined"!=typeof window,e=t&&!("onscroll"in window)||"undefined"!=typeof navigator&&/(gle|ing|ro)bot|crawl|spider/i.test(navigator.userAgent),a=t&&"IntersectionObserver"in window,s=t&&"classList"in document.createElement("p"),o={elements_selector:"img",container:e||t?document:null,threshold:300,thresholds:null,data_src:"src",data_srcset:"srcset",data_sizes:"sizes",data_bg:"bg",data_poster:"poster",class_loading:"loading",class_loaded:"loaded",class_error:"error",load_delay:0,auto_unobserve:!0,callback_enter:null,callback_exit:null,callback_loading:null,callback_loaded:null,callback_error:null,callback_finish:null,use_native:!1},l=t=>Object.assign({},o,t),n=function(t,e){var a;let s=new t(e);try{a=new CustomEvent("LazyLoad::Initialized",{detail:{instance:s}})}catch(t){(a=document.createEvent("CustomEvent")).initCustomEvent("LazyLoad::Initialized",!1,!1,{instance:s})}window.dispatchEvent(a)},r=(t,e)=>t.getAttribute("data-"+e),i=(t,e,a)=>{var s="data-"+e;null!==a?t.setAttribute(s,a):t.removeAttribute(s)},c=(t,e)=>i(t,"ll-status",e),d=(t,e)=>i(t,"ll-timeout",e),u=t=>r(t,"ll-timeout"),_=t=>{let e=[];for(let a,s=0;a=t.children[s];s+=1)"SOURCE"===a.tagName&&e.push(a);return e},g=(t,e,a)=>{a&&t.setAttribute(e,a)},h=(t,e)=>{g(t,"sizes",r(t,e.data_sizes)),g(t,"srcset",r(t,e.data_srcset)),g(t,"src",r(t,e.data_src))},b={IMG:(t,e)=>{const a=t.parentNode;if(a&&"PICTURE"===a.tagName){_(a).forEach(t=>{h(t,e)})}h(t,e)},IFRAME:(t,e)=>{g(t,"src",r(t,e.data_src))},VIDEO:(t,e)=>{_(t).forEach(t=>{g(t,"src",r(t,e.data_src))}),g(t,"poster",r(t,e.data_poster)),g(t,"src",r(t,e.data_src)),t.load()}},v=(t,e,a)=>{const s=t.tagName,o=b[s];o?(o(t,e),(t=>{t&&(t.loadingCount+=1)})(a)):((t,e)=>{const a=r(t,e.data_src),s=r(t,e.data_bg);a&&(t.style.backgroundImage=`url("${a}")`),s&&(t.style.backgroundImage=s)})(t,e)},f=(t,e)=>{s?t.classList.add(e):t.className+=(t.className?" ":"")+e},m=(t,e)=>{s?t.classList.remove(e):t.className=t.className.replace(new RegExp("(^|\\s+)"+e+"(\\s+|$)")," ").replace(/^\s+/,"").replace(/\s+$/,"")},p=(t,e,a,s)=>{t&&(void 0===s?void 0===a?t(e):t(e,a):t(e,a,s))},E=(t,e)=>{e&&(e.loadingCount-=1,y(t,e))},y=(t,e)=>{e.toLoadCount||e.loadingCount||p(t.callback_finish,e)},w=(t,e,a)=>{t.addEventListener(e,a)},I=(t,e,a)=>{t.removeEventListener(e,a)},L=(t,e,a)=>{I(t,"load",e),I(t,"loadeddata",e),I(t,"error",a)},k=(t,e,a)=>{const s=l=>{((t,e,a)=>{const s=t.target;c(s,"loaded"),m(s,e.class_loading),f(s,e.class_loaded),p(e.callback_loaded,s,a),E(e,a)})(l,e,a),L(t,s,o)},o=l=>{((t,e,a)=>{const s=t.target;c(s,"error"),m(s,e.class_loading),f(s,e.class_error),p(e.callback_error,s,a),E(e,a)})(l,e,a),L(t,s,o)};((t,e,a)=>{w(t,"load",e),w(t,"loadeddata",e),w(t,"error",a)})(t,s,o)},C=["IMG","IFRAME","VIDEO"],A=(t,e,a)=>{(t=>C.indexOf(t.tagName)>-1)(t)&&(k(t,e,a),f(t,e.class_loading)),v(t,e,a),((t,e)=>{e&&(e.toLoadCount-=1,y(t,e))})(e,a)},z=(t,e,a)=>{A(t,e,a),c(t,"loading"),p(e.callback_loading,t,a),p(e.callback_reveal,t,a),((t,e)=>{if(!e)return;const a=e._observer;a&&e._settings.auto_unobserve&&a.unobserve(t)})(t,a)},N=t=>{var e=u(t);e&&(clearTimeout(e),d(t,null))},O=(t,e,a)=>{const s=a._settings;p(s.callback_enter,t,e,a),s.load_delay?((t,e,a)=>{const s=e.load_delay;let o=u(t);o||(o=setTimeout((function(){z(t,e,a),N(t)}),s),d(t,o))})(t,s,a):z(t,s,a)},M=["IMG","IFRAME"],x=t=>t.use_native&&"loading"in HTMLImageElement.prototype,R=(t,e,a)=>{t.forEach(t=>{-1!==M.indexOf(t.tagName)&&(t.setAttribute("loading","lazy"),((t,e,a)=>{A(t,e,a),c(t,"native")})(t,e,a))}),a.toLoadCount=0},T=(t,e)=>{(t=>{t.disconnect()})(t),((t,e)=>{e.forEach(e=>{t.observe(e),c(e,"observed")})})(t,e)},F=t=>{var e;a&&!x(t._settings)&&(t._observer=new IntersectionObserver(e=>{e.forEach(e=>(t=>t.isIntersecting||t.intersectionRatio>0)(e)?O(e.target,e,t):((t,e,a)=>{const s=a._settings;p(s.callback_exit,t,e,a),s.load_delay&&N(t)})(e.target,e,t))},{root:(e=t._settings).container===document?null:e.container,rootMargin:e.thresholds||e.threshold+"px"}))},G=t=>Array.prototype.slice.call(t),$=t=>t.container.querySelectorAll(t.elements_selector),D=t=>!(t=>null!==r(t,"ll-status"))(t)||(t=>"observed"===r(t,"ll-status"))(t),S=t=>(t=>"error"===r(t,"ll-status"))(t),U=(t,e)=>(t=>G(t).filter(D))(t||$(e)),V=t=>{const e=t._settings;var a;(a=$(e),G(a).filter(S)).forEach(t=>{m(t,e.class_error),(t=>{i(t,"ll-status",null)})(t)}),t.update()},j=function(e,a){var s;this._settings=l(e),this.loadingCount=0,F(this),s=this,t&&window.addEventListener("online",t=>{V(s)}),this.update(a)};j.prototype={update:function(t){const s=this._settings,o=U(t,s);this.toLoadCount=o.length,!e&&a?x(s)?R(o,s,this):T(this._observer,o):this.loadAll(o)},destroy:function(){this._observer&&this._observer.disconnect(),delete this._observer,delete this._settings,delete this.loadingCount,delete this.toLoadCount},loadAll:function(t){const e=this._settings;U(t,e).forEach(t=>{z(t,e,this)})},load:function(t){z(t,this._settings,this)}},j.load=(t,e)=>{const a=l(e);z(t,a)},t&&((t,e)=>{if(e)if(e.length)for(let a,s=0;a=e[s];s+=1)n(t,a);else n(t,e)})(j,window.lazyLoadOptions);export default j;
